<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Title</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="/css/font.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
          crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <style>
      .navbar {
          position: absolute;
          right: 20px;
          top: 45%;
          transform: translateY(-50%);
          transition: top 0.7s ease-out;
      }

      .star-rating {
          width: 100%;
          box-sizing: border-box;
          display: inline-flex;
          float: left;
          flex-direction: row;
          justify-content: flex-start;
      }

      .star-rating .star {
          width: 25px;
          height: 25px;
          margin-right: 10px;
          display: inline-block;
          background: url("/img/star-x.png") no-repeat;
          background-size: 100%;
          box-sizing: border-box;
      }

      .star-rating .star.on {
          width: 25px;
          height: 25px;
          margin-right: 10px;
          display: inline-block;
          background: url("/img/star-o.png") no-repeat;
          background-size: 100%;
          box-sizing: border-box;
      }

  </style>

  <script>
      $(document).ready(function () {
          var nav = parseInt($("#right-nav").css('top'));

          $(window).scroll(function () {
              var scrollTop = $(window).scrollTop();
              var nav_position = scrollTop + nav + "px";

              $("#right-nav").stop().animate({
                  "top": nav_position
              }, 700);
          }).scroll();
      });
  </script>

  <script>
      $(document).ready(function () {
        $(".star-rating .star").click(function () {
          let rating = $(this).data("value"); // 선택한 별의 값 가져오기
          $("#rating").val(rating); // hidden input에 값 저장
          console.log("선택한 별점: " + rating); // 확인용 콘솔 출력

          // 별 스타일 적용
          $(this).siblings('.star').removeClass('on');
          $(this).addClass('on').prevAll('.star').addClass('on');
        });

        // 리뷰 등록 버튼 클릭 이벤트
        $("form").submit(function (event) {
          event.preventDefault(); // 기본 제출 동작 방지

          let star = $("#rating").val(); // 별점 값
          let comment = $("textarea").val(); // 리뷰 내용
          let placeIdx = $("#placeIdx").val(); // 장소 ID
          // let userIdx = $("#userIdx").val(); // 사용자 ID

          if (!star || !comment) {
            alert("별점과 리뷰 내용을 입력해주세요.");
            return;
          }

          $.ajax({
            type: "POST",
            url: "/review/write", // Spring Boot에서 받을 API 경로
            // contentType : 'application/json',
            // data: JSON.stringify({
            //   placeIdx: placeIdx,
            //   star: star,
            //   comment: comment
            // }),

            data: {
                placeIdx: placeIdx,
                star: star,
                comment: comment
            },
            success: function (response) {
              alert("리뷰가 등록되었습니다!");
              location.reload(); // 새로고침
            },
            error: function (xhr, status, error) {
              console.error("리뷰 등록 실패:", xhr, status, error);
              console.log("placeIdx:", placeIdx);
              console.log("userId:", $("#userIdx").val());
              alert("리뷰 등록에 실패했습니다.");
            }
          });
        });
      });



  </script>

</head>
<body>
<div th:replace="~{/layout/header :: projectheader}"></div>

<!-- 상세보기의 메인 사진,글 -->
<section class="container mt-5">
  <div>
    <div>
      <h4 class="fw-bold p-3">인기 활동</h4>
    </div>
    <div class="row justify-content-center">
      <div class="col-6"><img src="/img/luge1.jpg" alt=".." class="rounded-start-3"
                              style="width: 650px; height: 510px;"></div>
      <div class="col-6 row row-cols-2">
        <div><img src="/img/luge1.jpg" alt="" style="width: 310px; height: 252px;"></div>
        <div><img src="/img/luge2.jpg" alt="" class="rounded-end-3" style="width: 310px; height: 252px;"></div>
        <div><img src="/img/skyRide.jpg" alt="" style="width: 310px; height: 252px;"></div>
        <div><img src="/img/climbing.jpg" alt="" class="rounded-end-3" style="width: 310px; height: 252px;"></div>
      </div>
    </div>
    <div class="container">
      <h3 class="mt-3" style="font-weight: bold;">SKY LINE LUGE</h3>
      <h5 class="mt-3">스카이라인 루지 부산에서 다양한 액티비티를 경험해 보세요!</h5>
      <p>총 2.4km에 이르는 짜릿한 루지 트랙을 경험할 수 있습니다!
        대한민국의 활기찬 도시 부산에 위치한 스카이라인 루지 부산은 모든 연령대의 방문객들에게 지금껏 느껴보지 못했던 경험을 할 수 있도록 약속합니다.
        그리고 보다 더 큰 짜릿함을 원한다면 아름다운 풍경을 보며 활강하는 하이플라이와 프리폴 점프를 놓치지 마세요!</p>
    </div>
  </div>
</section>

<!-- 상세 설명 -->
<section class="container mt-5" th:each="place : ${places}">
  <div style="margin-left: 15px;">
    <div class="row py-3 border-top border-bottom">
      <div class="col-2 border-end"><i class="fa-solid fa-house"></i> 주소</div>
      <div class="col-10">부산광역시</div>
    </div>
    <div class="row py-3 border-bottom">
      <div class="col-2 border-end"><i class="fa-regular fa-clock"></i> 운영시간</div>
      <div class="col-4 border-end">10:00</div>
      <div class="col-2 border-end"><i class="fa-solid fa-phone"></i> 연락처</div>
      <div class="col-4 ">00000-0000</div>
    </div>
    <div class="row py-3 border-bottom">
      <div class="col-2 border-end"><i class="fa-solid fa-dice"></i> 서비스</div>
      <div class="col-10">주차,룸</div>
    </div>
  </div>
</section>

<!-- 리뷰 부분 -->
<section class="container mt-5">
  <div>
    <div class="row justify-content-between align-items-end border-bottom py-2">
      <div class="col-auto"><h5>리뷰 & 평가</h5></div>
      <div class="col-auto">
        <button type="button" class="btn btn-outline-secondary">평가하기</button>
      </div>
    </div>
    <div th:each="review : ${reviews}">
      <div class="row py-3">
        <input type="hidden" id="placeIdx" th:value="${review.placeReview.placeIdx}">
        <input type="hidden" id="userIdx" th:value="${review.userReview.user_idx}">
        <div class="col-1"><i class="fa-regular fa-user"></i> 작성자</div>
        <div class="col-3" th:text="${review.userReview.id}"></div>
        <div class="col-1">작성일</div>
        <div class="col-4" th:text="${review.writeDate}"></div>
      </div>
      <div class="row justify-content-between py-3" >
        <div class="col-9" style="word-break:keep-all;" th:text="${review.comment}">(댓글)</div>
        <div class="col-3 text-end">
          <span th:each="i : ${#numbers.sequence(1, 5)}" style="display: inline-flex;">
            <i class="fa-star" th:classappend="${i <= review.star} ? 'fas text-warning' : 'far'"></i>
          </span></div>
      </div>
    </div>
    <form>
      <input type="hidden" id="rating" name="rating">
      <div class="row mt-5">
        <div class="star-rating">
          <span class="star on" data-value="1"></span>
          <span class="star" data-value="2"></span>
          <span class="star" data-value="3"></span>
          <span class="star" data-value="4"></span>
          <span class="star" data-value="5"></span>
        </div>
      </div>
      <div class="row mt-3">
        <textarea class="rounded-2" placeholder="리뷰 내용을 작성해주세요."></textarea>
        <div class="text-end py-3">
          <input type="submit" class="btn btn-primary" value="등록">
        </div>
      </div>
    </form>
  </div>
</section>

<!-- 메인의 추천 활동 top3-->
<section class="container-fluid" style="margin-top: 100px;">
  <div class="container-sm" style="padding-left: 10%; margin-bottom: 40px;"><h4>추천활동 TOP3</h4></div>
  <div class="container-lg d-flex justify-content-center">
    <div style="margin-right: 100px;">
      <div><img src="/img/climbing.jpg" alt="top1-img" style="width: 150px; border-radius: 5px;"></div>
      <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
        <p style="margin-bottom: 0;">
          <a href="#" class="text-dark" style="text-decoration: none; font-size: small;"><p
              style="margin-bottom: 0;">22:30 영업 종료</p>
            <p>부산 진구 부전동</p>
          </a>
        </p>
      </div>
    </div>
    <div style="margin-right: 100px;">
      <div><img src="/img/climbing.jpg" alt="top1-img" style="width: 150px; border-radius: 5px;"></div>
      <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
        <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;"><p
            style="margin-bottom: 0;">22:30 영업 종료</p>
          <p>부산 진구 부전동</p></a></p>
      </div>
    </div>
    <div style="margin-right: 100px;">
      <div><img src="/img/climbing.jpg" alt="top1-img" style="width: 150px; border-radius: 5px;"></div>
      <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
        <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;"><p
            style="margin-bottom: 0;">22:30 영업 종료</p>
          <p>부산 진구 부전동</p></a></p>
      </div>
    </div>
  </div>
</section>


<nav class="navbar" id="right-nav">
  <div style="width: 250px; border: 1px solid lightgray; border-radius: 5px; padding: 10px; margin-left: 20px;">
    <div class="text-center" style="margin-bottom: 10px;">
      <button type="button" class="border-0" style="border-radius: 5px;">
        <a href="/templates/board/crewPage.html" class="font-weight-bold text-dark"
           style="text-decoration: none;">파티 구함<i class="fa-solid fa-fire"></i></a>
      </button>
    </div>
    <div>
      <h5 class="text-center" style="margin-bottom: 20px;">이런 활동 어떠세요?</h5>
      <div class="d-flex justify-content-around align-items-center">
        <div><img src="/img/climbing.jpg" alt="climbing-img"
                  style="width: 88px; border-radius: 5px; margin-right: 5px;"></div>
        <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
          <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;"><p
              style="margin-bottom: 0;">22:30 영업 종료</p>
            <p>부산 진구 부전동</p></a></p>
        </div>
      </div>
      <div>
        <div class="d-flex justify-content-around align-items-center">
          <div><img src="/img/climbing.jpg" alt="climbing-img"
                    style="width: 88px; border-radius: 5px; margin-right: 5px;"></div>
          <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
            <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;">
              <p style="margin-bottom: 0;">22:30 영업 종료</p>
              <p>부산 진구 부전동</p></a></p>
          </div>
        </div>
      </div>
      <div>
        <div class="d-flex justify-content-around align-items-center">
          <div><img src="/img/climbing.jpg" alt="climbing-img"
                    style="width: 88px; border-radius: 5px; margin-right: 5px;"></div>
          <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
            <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;">
              <p style="margin-bottom: 0;">22:30 영업 종료</p>
              <p>부산 진구 부전동</p></a></p>
          </div>
        </div>
      </div>
      <div>
        <div class="d-flex justify-content-around align-items-center">
          <div><img src="/img/climbing.jpg" alt="climbing-img"
                    style="width: 88px; border-radius: 5px; margin-right: 5px;"></div>
          <div><a href="#" style="text-decoration: none;"><span style="font-size: small;">웨이브락 클라이밍 서면점</span></a>
            <p style="margin-bottom: 0;"><a href="#" class="text-dark" style="text-decoration: none; font-size: small;">
              <p style="margin-bottom: 0;">22:30 영업 종료</p>
              <p>부산 진구 부전동</p></a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<div th:replace="~{/layout/footer :: projectfooter}"></div>
</body>
</html>